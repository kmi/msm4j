<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-10-15
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20151015" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MSM4J - Developing Transformers</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/kmi/msm4j">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../" id="bannerLeft">
                                                                                                <img src="images/iServe-logo.png"  alt="MSM4J" width="263" height="475"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-10-15</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.3.3</li>
                      
                
                    
      
                                              
    <li class="pull-right">              <a href="http://kmi.open.ac.uk" class="externalLink" title="KMi">
        KMi</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="../" title="iServe">
        iServe</a>
  </li>

                        </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                                
      <li>
    
                          <a href="index.html" title="About">
          <i class="none"></i>
        About</a>
            </li>
                  
      <li>
    
                          <a href="overview.html" title="Overview">
          <i class="none"></i>
        Overview</a>
            </li>
                  
      <li>
    
                          <a href="data-model.html" title="Data Model">
          <i class="none"></i>
        Data Model</a>
            </li>
                  
      <li>
    
                          <a href="compiling.html" title="Compiling MSM4J">
          <i class="none"></i>
        Compiling MSM4J</a>
            </li>
                  
      <li>
    
                          <a href="usage.html" title="Using MSM4J">
          <i class="none"></i>
        Using MSM4J</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Transformers</a>
          </li>
                              <li class="nav-header">Reports</li>
                                                                                                                                                                                              
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                    
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Extending MSM4J<a name="Extending_MSM4J"></a></h2>
<p>We have tried to support a certain degree of extensibility for MSM4J by providing a plugin mechanism so that 3rd party developers can provide their own import mechanisms for new formats. The plugin mechanism is based on Java's ServiceLoader combined with <a class="externalLink" href="http://code.google.com/p/google-guice/"> Guice</a> to support the automated detection and use of plugin implementations at runtime, and can therefore be exploited simply by dropping a new jar in the classpath.</p>
<ul>
<li><a href="#Developing_a_new_Import_Plugin">Developing a new Import Plugin</a>
<ul>
<li><a href="#Dependencies">Dependencies</a></li>
<li><a href="#Testing_that_the_Plugin_Mechanism_Works">Testing that the Plugin Mechanism Works</a></li></ul></li></ul>
<div class="section">
<h3><a name="Developing_a_new_Import_Plugin">Developing a new Import Plugin</a></h3>
<p>Providing an import plugin requires two main things. First and foremost you must implement the code for transforming service descriptions in the format you want to be able to import, to the ones MSM4J can handle. You should for this simply provide an implementation of the <i>uk.ac.open.msm4j.io.ServiceTransformer</i> interface.</p>
<p>Once implemented you should also provide a Guice module that ensures you declare your new implementation as a binding for ServiceTransformer. Given that many implementations of this method may be available at runtime, we make use of <a class="externalLink" href="http://code.google.com/p/google-guice/wiki/Multibindings"> Guice's multibinding mechanism</a> and index each implementation by the media type they support. Note that should there be service formats with the same media type, the engine will have no means to know how to choose the right one so be sure to chose a new one or remove the competing implementation from your classpath. Below you have a simple example on how such a Guice module should look like.</p>
<div class="source">
<pre>
public class OwlsTransformationPlugin extends AbstractModule implements TransformationPluginModule {

    @Override
    protected void configure() {
        MapBinder&lt;String,ServiceTransformer&gt; binder = MapBinder.newMapBinder(binder(), String.class, ServiceTransformer.class);
        binder.addBinding(OwlsTransformer.mediaType).to(OwlsTransformer.class);
    }
}
</pre></div>
<p>The final thing required for the plugin to be automatically picked up by MSM4J is to provide the appropriate information for <a class="externalLink" href="http://docs.oracle.com/javase/6/docs/api/java/util/ServiceLoader.html"> Java's ServiceLoader</a> to locate your implementation. You should do this creating a file at <i>META-INF/services/uk.ac.open.kmi.msm4j.io.TransformationPluginModule</i>. The content of the file should just include a line with the complete name of your plugin implementation, eg., :</p>
<div class="source">
<pre>uk.ac.open.kmi.msm4j.transformer.OwlsTransformationPlugin</pre></div>
<p>Developers using Maven can automate this last step easily by using <i>serviceloader-maven-plugin</i>. To do so, simply include the following in your plugin's POM file:</p>
<div class="source">
<pre>&lt;!-- Generate the META-INF/services information for ServiceLoader --&gt;
&lt;plugin&gt;
    &lt;groupId&gt;eu.somatik.serviceloader-maven-plugin&lt;/groupId&gt;
    &lt;artifactId&gt;serviceloader-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.2&lt;/version&gt;
    &lt;configuration&gt;
        &lt;services&gt;
            &lt;param&gt;uk.ac.open.kmi.msm4j.io.TransformationPluginModule&lt;/param&gt;
        &lt;/services&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;generate&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;</pre></div>
<div class="section">
<h4><a name="Dependencies">Dependencies</a></h4>
<p>Given that we use Guice and its multibinding extension for the plugin mechanism, these are also dependencies for your plugin.</p>
<p>Maven users can include the necessary dependencies by including the following:</p>
<div class="source">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;uk.ac.open.kmi.msm4j&lt;/groupId&gt;
    &lt;artifactId&gt;msm4j-io&lt;/artifactId&gt;
    &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;

&lt;!--Add Guice for dependency injection --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.google.inject&lt;/groupId&gt;
    &lt;artifactId&gt;guice&lt;/artifactId&gt;
    &lt;version&gt;${guice.version}&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;com.google.inject.extensions&lt;/groupId&gt;
    &lt;artifactId&gt;guice-multibindings&lt;/artifactId&gt;
    &lt;version&gt;${guice.version}&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></div>
<div class="section">
<h4><a name="Testing_that_the_Plugin_Mechanism_Works">Testing that the Plugin Mechanism Works</a></h4>
<p>Should you wish to ensure that the plugin mechanism works and picks up properly your implementation, you can simply try our generic transformer over the services you wish to transform. Below you have an example on how this can be done.</p>
<div class="source">
<pre>// Obtain the transformation engine using Guice
Injector injector = Guice.createInjector(new TransformerModule());
ServiceTransformationEngine transformationEngine = injector.getInstance(ServiceTransformationEngine.class);
// Transform services
List&lt;Services&gt; services = transformationEngine.transform(file, null, OwlsTransformer.mediaType );</pre></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2015
                        <a href="http://kmi.open.ac.uk">Knowledge Media Institute - The Open University</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
